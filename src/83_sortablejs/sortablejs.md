# sortablejs å­¦ä¹ æ–‡æ¡£

> çº¯ JS çš„æ‹–æ‹½æ’åºåº“ï¼Œæ—  jQuery/æ¡†æ¶ä¾èµ–ï¼Œæ”¯æŒåˆ—è¡¨å†…æ’åºã€å¤šåˆ—è¡¨é—´æ‹–æ‹½ã€åµŒå¥—ã€æ‰‹æŸ„ç­‰

## ğŸ“š ç›®å½•

1. [ç”¨å¤§ç™½è¯è¯´ï¼šsortablejs æ˜¯å•¥](#ç”¨å¤§ç™½è¯è¯´sortablejs-æ˜¯å•¥)
2. [åŸç†ï¼šæ‹–æ‹½ä¸ DOM é‡æ’](#åŸç†æ‹–æ‹½ä¸-dom-é‡æ’)
3. [ä¸ Vue.Draggableã€react-sortablejs çš„å…³ç³»](#ä¸-vuedraggablereact-sortablejs-çš„å…³ç³»)
4. [å®‰è£…ä¸ä½¿ç”¨æ–¹å¼](#å®‰è£…ä¸ä½¿ç”¨æ–¹å¼)
5. [æ ¸å¿ƒ APIï¼šnew Sortableã€options](#æ ¸å¿ƒ-apinew-sortableoptions)
6. [å¸¸ç”¨é€‰é¡¹ï¼šanimationã€handleã€group](#å¸¸ç”¨é€‰é¡¹animationhandlegroup)
7. [äº‹ä»¶ä¸æ–¹æ³•](#äº‹ä»¶ä¸æ–¹æ³•)
8. [å¸¸è§åœºæ™¯ä¸æœ€ä½³å®è·µ](#å¸¸è§åœºæ™¯ä¸æœ€ä½³å®è·µ)
9. [å‚è€ƒä¸å»¶ä¼¸é˜…è¯»](#å‚è€ƒä¸å»¶ä¼¸é˜…è¯»)

---

## ç”¨å¤§ç™½è¯è¯´ï¼šsortablejs æ˜¯å•¥

### ä½ é‡åˆ°çš„é—®é¢˜ï¼ˆè¦åšæ‹–æ‹½æ’åºæ—¶ï¼‰

- **åˆ—è¡¨å¯æ‹–æ‹½æ’åº**ï¼šå¸Œæœ›ç”¨æˆ·ç”¨é¼ æ ‡/è§¦æ‘¸æ‹–æ‹½åˆ—è¡¨é¡¹æ”¹å˜é¡ºåºï¼Œæ— éœ€æ¡†æ¶ç»‘æ­»ã€‚
- **å¤šåˆ—è¡¨é—´æ‹–æ‹½**ï¼šå¦‚çœ‹æ¿åˆ—ä¹‹é—´æ‹–æ‹½å¡ç‰‡ã€å¤šé€‰åˆ—è¡¨ä¸å·²é€‰åˆ—è¡¨ä¹‹é—´æ‹–æ‹½ã€‚
- **æ— ä¾èµ–**ï¼šä¸æƒ³å¼•å…¥ jQuery æˆ–å¤§å‹æ¡†æ¶ï¼Œåªè¦ä¸€ä¸ªè½»é‡è„šæœ¬ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼š**åœ¨ã€Œçº¯ JSã€æ— æ¡†æ¶ä¾èµ–çš„æ‹–æ‹½æ’åºã€è¿™ä»¶äº‹ä¸Šï¼Œæä¾› API ä¸ä¸°å¯Œé€‰é¡¹**ï¼Œå°±æ˜¯ sortablejs è¦è§£å†³çš„é—®é¢˜ã€‚

### sortablejs å¸®ä½ åšå•¥

**SortableJS**ï¼ˆSortableJS ç¤¾åŒºç»´æŠ¤ï¼‰æ˜¯ä¸€ä¸ª **æ‹–æ‹½æ’åºåº“**ï¼š

1. **å•åˆ—è¡¨æ’åº**ï¼šåœ¨ä¸€ä¸ªåˆ—è¡¨å†…æ‹–æ‹½é¡¹æ”¹å˜é¡ºåºï¼›æ”¯æŒåŠ¨ç”»ã€æ‰‹æŸ„ã€è¿‡æ»¤æŸäº›é¡¹ä¸å¯æ‹–ã€‚
2. **å¤šåˆ—è¡¨**ï¼šé€šè¿‡ `group` è®©å¤šä¸ªåˆ—è¡¨ä¹‹é—´å¯æ‹–æ‹½ç§»åŠ¨æˆ–å¤åˆ¶ï¼ˆcloneï¼‰ã€‚
3. **åµŒå¥—**ï¼šæ”¯æŒåµŒå¥—åˆ—è¡¨ï¼ˆçˆ¶å­å±‚çº§ï¼‰å„è‡ªæ’åºã€‚
4. **æ‰‹æŸ„**ï¼šå¯é™åˆ¶åªæœ‰æŸä¸ªå­å…ƒç´ ï¼ˆå¦‚å›¾æ ‡ï¼‰ä½œä¸ºæ‹–æ‹½æ‰‹æŸ„ï¼Œé¿å…æ•´è¡Œè¯¯è§¦ã€‚
5. **æ— ä¾èµ–**ï¼šçº¯ JavaScriptï¼Œä¸ä¾èµ– jQuery æˆ– Vue/Reactï¼›Vue/React æœ‰å®˜æ–¹ç»‘å®šåº“ï¼ˆVue.Draggableã€react-sortablejsï¼‰ã€‚
6. **äº‹ä»¶**ï¼šæä¾› `onStart`ã€`onEnd`ã€`onUpdate` ç­‰ï¼Œä¾¿äºåŒæ­¥æ•°æ®æˆ–ä¿å­˜é¡ºåºã€‚

ä¸€å¥è¯ï¼š**sortablejs = çº¯ JS çš„ã€Œå¯æ‹–æ‹½æ’åºåˆ—è¡¨ã€**ï¼Œæ”¯æŒå•åˆ—è¡¨ã€å¤šåˆ—è¡¨ã€åµŒå¥—ã€æ‰‹æŸ„ã€‚

---

## åŸç†ï¼šæ‹–æ‹½ä¸ DOM é‡æ’

- **æ‹–æ‹½**ï¼šç›‘å¬ mousedown/touchstartï¼Œåœ¨ move æ—¶è®¡ç®—æ’å…¥ä½ç½®ï¼Œç”¨å ä½å…ƒç´ æˆ–åŠ¨ç”»è¡¨ç°ã€Œæ‹–æ‹½ä¸­ã€ï¼›æ¾å¼€æ—¶æŠŠ DOM èŠ‚ç‚¹æ’å…¥åˆ°æ–°ä½ç½®ï¼Œæˆ–é€šè¿‡äº‹ä»¶æŠŠæ–°é¡ºåºé€šçŸ¥ç»™æ¡†æ¶ï¼ˆVue/React ç”±ç»‘å®šåº“æ›´æ–°æ•°æ®å†æ¸²æŸ“ï¼‰ã€‚
- **DOM é‡æ’**ï¼šSortable ç›´æ¥æ“ä½œ DOM ç§»åŠ¨èŠ‚ç‚¹ï¼›åœ¨ Vue/React ä¸­é€šå¸¸é…åˆ `onUpdate` ç­‰äº‹ä»¶æ›´æ–°æ•°æ®ï¼Œå†ç”±æ¡†æ¶é‡æ–°æ¸²æŸ“ï¼Œé¿å…çŠ¶æ€ä¸ DOM ä¸åŒæ­¥ã€‚
- **å…¼å®¹**ï¼šæ”¯æŒè§¦æ‘¸è®¾å¤‡ä¸æ¡Œé¢ï¼Œå¤„ç†äº†é»˜è®¤è¡Œä¸ºä¸ç„¦ç‚¹ç­‰ã€‚

---

## ä¸ Vue.Draggableã€react-sortablejs çš„å…³ç³»

| è§’è‰² | ä½œç”¨ |
|------|------|
| **sortablejs** | æ ¸å¿ƒåº“ï¼Œçº¯ JSï¼Œç›´æ¥æ“ä½œ DOMï¼›æ— æ¡†æ¶ä¾èµ–ã€‚ |
| **Vue.Draggable / vue.draggable.next** | Vue 2 / Vue 3 çš„å®˜æ–¹ç»‘å®šï¼Œå†…éƒ¨ç”¨ SortableJSï¼Œæä¾› v-model æˆ– list åŒæ­¥ã€‚ |
| **react-sortablejs** | React çš„å®˜æ–¹ç»‘å®šï¼Œå†…éƒ¨ç”¨ SortableJSï¼Œæä¾›ç»„ä»¶ä¸ list åŒæ­¥ã€‚ |

**ç®€å•è®°**ï¼šsortablejs æ˜¯æ ¸å¿ƒï¼›Vue/React é¡¹ç›®å¯ç”¨å¯¹åº”ç»‘å®šåº“ï¼Œæ•°æ®ä¸åˆ—è¡¨åŒæ­¥æ›´çœå¿ƒã€‚

---

## å®‰è£…ä¸ä½¿ç”¨æ–¹å¼

### å®‰è£…

```bash
pnpm add sortablejs
# æˆ–
npm i sortablejs
```

### ä½¿ç”¨æ–¹å¼

- **çº¯ HTML/JS**ï¼šåœ¨åˆ—è¡¨å®¹å™¨ä¸Š `new Sortable(element, options)`ï¼Œåˆ—è¡¨é¡¹ä¸ºå­å…ƒç´ ï¼ˆå¦‚ `li`ã€`div`ï¼‰ã€‚
- **Vue/React**ï¼šç”¨ Vue.Draggableã€react-sortablejs ç­‰åŒ…è£…ï¼Œä¼  list ä¸äº‹ä»¶åŒæ­¥æ•°æ®ã€‚

---

## æ ¸å¿ƒ APIï¼šnew Sortableã€options

### åŸºæœ¬ç”¨æ³•

```javascript
import Sortable from 'sortablejs';

const el = document.getElementById('list');
const sortable = new Sortable(el, {
  animation: 150,
  ghostClass: 'sortable-ghost',
  onEnd: (evt) => {
    console.log('æ–°é¡ºåº:', evt.oldIndex, '->', evt.newIndex);
  },
});
```

- **Sortable(element, options)**ï¼šåœ¨ `element`ï¼ˆåˆ—è¡¨å®¹å™¨ï¼‰ä¸Šå¯ç”¨æ’åºï¼Œè¿”å› Sortable å®ä¾‹ï¼›å¯è°ƒç”¨ `sort()`ã€`destroy()` ç­‰æ–¹æ³•ã€‚
- **element**ï¼šå­èŠ‚ç‚¹ä¸ºå¯æ’åºé¡¹ï¼Œé€šå¸¸ä¸º `ul > li` æˆ– `div > div`ã€‚

---

## å¸¸ç”¨é€‰é¡¹ï¼šanimationã€handleã€group

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| **animation** | åŠ¨ç”»æ—¶é•¿ï¼ˆmsï¼‰ï¼Œé»˜è®¤ 0ï¼›è®¾ 150 ç­‰æœ‰è¿‡æ¸¡æ•ˆæœã€‚ |
| **ghostClass** | æ‹–æ‹½æ—¶å ä½å…ƒç´ çš„ classï¼Œç”¨äºæ ·å¼ã€‚ |
| **chosenClass** | è¢«æ‹–æ‹½ä¸­å…ƒç´ çš„ classã€‚ |
| **dragClass** | æ‹–æ‹½å…‹éš†å…ƒç´ çš„ classã€‚ |
| **handle** | é€‰æ‹©å™¨ï¼Œåªæœ‰åŒ¹é…å…ƒç´ ä½œä¸ºæ‹–æ‹½æ‰‹æŸ„æ—¶æ‰å¯æ‹–ï¼›ä¸è®¾åˆ™æ•´é¡¹å¯æ‹–ã€‚ |
| **filter** | é€‰æ‹©å™¨ï¼ŒåŒ¹é…å…ƒç´ ä¸å¯æ‹–ã€‚ |
| **group** | å¤šåˆ—è¡¨å…±äº«åŒä¸€ name æ—¶å¯äº’ç›¸æ‹–æ‹½ï¼›`pull: true/false/'clone'`ã€`put: true/false` æ§åˆ¶æ˜¯å¦å¯æ‹‰å‡º/æ”¾å…¥ã€æ˜¯å¦å¤åˆ¶ã€‚ |
| **sort** | æ˜¯å¦å…è®¸åˆ—è¡¨å†…æ’åºï¼Œé»˜è®¤ trueã€‚ |
| **onStart / onEnd / onUpdate** | æ‹–æ‹½å¼€å§‹ã€ç»“æŸã€é¡ºåºå˜åŒ–æ—¶çš„å›è°ƒã€‚ |

### group ç¤ºä¾‹ï¼ˆå¤šåˆ—è¡¨ï¼‰

```javascript
Sortable.create(list1, { group: 'shared', animation: 150 });
Sortable.create(list2, { group: 'shared', animation: 150 });
```

---

## äº‹ä»¶ä¸æ–¹æ³•

### å¸¸ç”¨äº‹ä»¶

- **onStart(evt)**ï¼šå¼€å§‹æ‹–æ‹½ï¼›evt.itemã€evt.from ç­‰ã€‚
- **onEnd(evt)**ï¼šæ‹–æ‹½ç»“æŸï¼›evt.oldIndexã€evt.newIndexã€evt.fromã€evt.toã€‚
- **onUpdate(evt)**ï¼šåˆ—è¡¨é¡ºåºå˜åŒ–ï¼ˆåŒåˆ—è¡¨å†…æ’åºï¼‰ï¼›evt.oldIndexã€evt.newIndexã€‚
- **onAdd(evt)**ï¼šä»å…¶å®ƒåˆ—è¡¨æ‹–å…¥æœ¬åˆ—è¡¨æ—¶ã€‚

### å®ä¾‹æ–¹æ³•

- **sort(order)**ï¼šæŒ‰æ•°ç»„ order é‡æ–°æ’åº DOMã€‚
- **destroy()**ï¼šé”€æ¯å®ä¾‹ï¼Œç§»é™¤æ‹–æ‹½èƒ½åŠ›ã€‚
- **option(name, value)**ï¼šåŠ¨æ€æ”¹é€‰é¡¹ã€‚

---

## å¸¸è§åœºæ™¯ä¸æœ€ä½³å®è·µ

1. **å•åˆ—è¡¨æ’åº**ï¼š`new Sortable(container, { animation: 150, onEnd: syncToBackend })`ï¼Œåœ¨ onEnd é‡ŒæŠŠæ–°é¡ºåºåŒæ­¥åˆ°æ¥å£æˆ–çŠ¶æ€ã€‚
2. **æ‰‹æŸ„**ï¼š`handle: '.handle'`ï¼Œåªæœ‰å¸¦ `.handle` çš„å…ƒç´ å¯è§¦å‘æ‹–æ‹½ï¼Œé¿å…æ•´è¡Œè¯¯è§¦ã€‚
3. **å¤šåˆ—è¡¨**ï¼šç”¨ `group: 'name'` è®©å¤šä¸ªåˆ—è¡¨å¯äº’ç›¸æ‹–æ‹½ï¼›ç”¨ `pull: 'clone'` å®ç°ã€Œä»æ¨¡æ¿åˆ—è¡¨å¤åˆ¶åˆ°ç›®æ ‡åˆ—è¡¨ã€ã€‚
4. **Vue/React**ï¼šç”¨ Vue.Draggableã€react-sortablejs åšæ•°æ®ç»‘å®šï¼Œé¿å…æ‰‹å†™ DOM ä¸çŠ¶æ€åŒæ­¥ã€‚

---

## å‚è€ƒä¸å»¶ä¼¸é˜…è¯»

- [SortableJS å®˜ç½‘](https://sortablejs.github.io/Sortable/)
- [SortableJS GitHub](https://github.com/SortableJS/Sortable)
- [sortablejs npm](https://www.npmjs.com/package/sortablejs)
- [Vue.Draggable](https://github.com/SortableJS/vue.draggable.next) Â· [react-sortablejs](https://github.com/SortableJS/react-sortablejs)
